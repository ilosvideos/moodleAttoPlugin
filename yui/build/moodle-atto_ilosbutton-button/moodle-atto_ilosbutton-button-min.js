YUI.add("moodle-atto_ilosbutton-button",function(e,t){var n="mbWjIVx83qaBLFMv8x8oIzilRqkGjJBwPy73yn50",r="https://cloud.ilosvideos.com/lti/embed",i=window.location.protocol+"//"+window.location.host,s="moodleLtiIframe",o="atto_ilosbutton",u="float:left; display:none",a='<iframe src="{{src}}" id="{{id}}" height="{{height}}" width="{{width}}" scrolling="auto"></iframe>';e.namespace("M.atto_ilosbutton").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){if(this.get("disabled"))return;var e="iconone";this.addButton({icon:"ed/"+e,iconComponent:"atto_ilosbutton",buttonName:e,callback:this._displayDialogue,callbackArgs:e})},_displayDialogue:function(e,t){var n=900,r=700,i=this.getDialogue({headerContent:M.util.get_string("dialogtitle",o),width:n+"px",height:r+"px",focusAfterHide:t});e.preventDefault(),i.after("visibleChange",function(){var e=i.getAttrs();e.visible===!1&&setTimeout(function(){i.reset()},5)}),i.width!==n+"px"&&i.set("width",n+"px"),i.height!==r+"px"&&i.set("height",r+"px"),i.set("bodyContent",this._getFormContent(t)),i.show(),this._doInsert(this)},_getFormContent:function(t){var f=i+"/mod/lti/return.php?course="+this.get("coursecontext"),l=r+"?oauth_consumer_key="+n+"&launch_presentation_return_url="+encodeURI(f)+"&tool_consumer_info_product_family_code=moodle",c=e.Handlebars.compile(a),h=e.Node.create(c({elementid:this.get("host").get("elementid"),component:o,clickedicon:t,src:l,height:650,width:850,id:s,selectalign:u}));return this._form=h,h},_doInsert:function(e){var t=document.getElementById(s);t.onload=function(){var n=t.contentDocument;if(!n)return;var r=n.getElementById("page-content").querySelector('[role="main"]'),i=r.innerText,s=i.search("https://");i=i.substr(s);if(i.indexOf("ilosvideos")<=0)return;var o='<iframe allowfullscreen="" frameborder="0" height="315" src="'+i+'" width="560"></iframe>';e.getDialogue({focusAfterHide:null}).hide(),e.editor.focus(),e.get("host").insertContentAtFocusPoint(o),e.markUpdated()}}},{ATTRS:{disabled:{value:!1},coursecontext:{value:null}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});

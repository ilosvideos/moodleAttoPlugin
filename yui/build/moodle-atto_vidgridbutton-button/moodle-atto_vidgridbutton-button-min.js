YUI.add("moodle-atto_vidgridbutton-button",function(o,t){var n="https://app.vidgrid.com/lti/embed",r="moodleLtiIframe",d="atto_vidgridbutton",s="float:left; display:none",a='<iframe src="{{src}}" id="{{id}}" height="{{height}}" width="{{width}}" scrolling="auto"></iframe>';o.namespace("M.atto_vidgridbutton").Button=o.Base.create("button",o.M.editor_atto.EditorPlugin,[],{initializer:function(){var t;this.get("disabled")||(t="iconone",this.addButton({icon:"ed/"+t,iconComponent:"atto_vidgridbutton",buttonName:t,callback:this._displayDialogue,callbackArgs:t}))},_displayDialogue:function(t,e){var i=this.getDialogue({headerContent:M.util.get_string("dialogtitle",d),width:"900px",height:"700px",focusAfterHide:e});t.preventDefault(),i.after("visibleChange",function(){!1===i.getAttrs().visible&&setTimeout(function(){i.reset()},5)}),"900px"!==i.width&&i.set("width","900px"),"700px"!==i.height&&i.set("height","700px"),i.set("bodyContent",this._getFormContent(e)),i.show(),this._doInsert(this)},_getFormContent:function(t){var e=this.get("sessKey"),i=this.get("webRoot")+"/mod/lti/return.php?course="+this.get("courseId")+"&sesskey="+e,e=this.get("orgApiKey"),e=n+"?oauth_consumer_key="+e+"&launch_presentation_return_url="+encodeURIComponent(i)+"&tool_consumer_info_product_family_code=moodle",i=o.Handlebars.compile(a),e=o.Node.create(i({elementid:this.get("host").get("elementid"),component:d,clickedicon:t,src:e,height:650,width:850,id:r,selectalign:s}));return this._form=e},_doInsert:function(i){var o=document.getElementById(r);o.onload=function(){var t,e=o.contentDocument;e&&(e=(t=e.getElementById("page-content").querySelector('[role="main"]').innerText).search("https://"),(t=t.substr(e)).indexOf("vidgrid")<=0||(t='<iframe allowfullscreen="" frameborder="0" height="315" src="'+t+'" width="560"></iframe>',i.getDialogue({focusAfterHide:null}).hide(),i.editor.focus(),i.get("host").insertContentAtFocusPoint(t),i.markUpdated()))}}},{ATTRS:{disabled:{value:!1},courseId:{value:null},orgApiKey:{value:null},webRoot:{value:null},sessKey:{value:null}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});